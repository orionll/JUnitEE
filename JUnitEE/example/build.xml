<?xml version="1.0"?>

<!--
	$Id: build.xml,v 1.1.1.1 2001-07-23 21:31:02 lhoriman Exp $
	$Source: C:\Users\Orionll\Desktop\junitee-cvs/JUnitEE/example/build.xml,v $
-->

<project name="junitee-example" default="app-ear" basedir=".">

	<property name="name" value="junitee-example" />

	<property name="output.dir" value="out" />

	<property name="javasrc.dir" value="javasrc" />
	<property name="javasrc.staging.dir" value="${output.dir}/${javasrc.dir}" />

	<property name="app-ear.dir" value="components/app-ear" />
	<property name="app-ear.product" value="${output.dir}/${name}.ear" />

	<property name="ejb-jar.dir" value="components/ejb-jar" />
	<property name="ejb-jar.file" value="${name}-ejb.jar" />
	<property name="ejb-jar.product" value="${output.dir}/${ejb-jar.file}" />

	<property name="web-war.dir" value="components/web-war" />
	<property name="web-war.file" value="${name}-web.war" />
	<property name="web-war.product" value="${output.dir}/${web-war.file}" />
	
	<property name="test-war.dir" value="components/test-war" />
	<property name="test-war.file" value="${name}-test.war" />
	<property name="test-war.product" value="${output.dir}/${test-war.file}" />

	<property name="orion.dir" value="/java/orion" />
	<property name="lib.dir" value="lib" />

	<path id="master-classpath">
		<pathelement location="${orion.dir}/orion.jar" />
		<pathelement location="${orion.dir}/ejb.jar" />
		<pathelement location="${orion.dir}/jndi.jar" />
		<pathelement location="${orion.dir}/lib/junitee.jar" />
		<pathelement location="/java/junit3.5/junit.jar" />
		<!--
		<fileset dir="${lib.dir}">
			<include name="**/*.jar" />
		</fileset>
		-->
	</path>

	<property name="debug" value="on" />


	<target name="clean">
		<delete dir="${output.dir}" />
	</target>

 	<target name="javasrc">
		<mkdir dir="${javasrc.staging.dir}" />
		<javac srcdir="${javasrc.dir}"
				destdir="${javasrc.staging.dir}"
				debug="${debug}">
			<classpath refid="master-classpath" />
		</javac>
	</target>

	<target name="ejb-jar" depends="javasrc">
		<jar jarfile="${ejb-jar.product}">
			<fileset dir="${ejb-jar.dir}" />

			<fileset dir="${javasrc.staging.dir}">
				<include name="org/infohazard/ejb/**/*.class" />
			</fileset>
		</jar>
	</target>

	<target name="web-war" depends="javasrc">
		<war warfile="${web-war.product}" webxml="${web-war.dir}/WEB-INF/web.xml">
			<fileset dir="${web-war.dir}" excludes="WEB-INF/**" />
		</war>
	</target>

	<target name="test-war" depends="javasrc">
		<war warfile="${test-war.product}" webxml="${test-war.dir}/WEB-INF/web.xml">
			<fileset dir="${test-war.dir}" excludes="WEB-INF/**" />
			
			<classes dir="${javasrc.staging.dir}">
				<include name="org/infohazard/servlet/**/*.class" />
				<include name="org/infohazard/test/**/*.class" />
			</classes>
		</war>
	</target>

	<target name="app-ear" depends="ejb-jar, web-war, test-war">
		<jar jarfile="${app-ear.product}">
			<fileset dir="${app-ear.dir}" />

			<fileset dir="${output.dir}">
				<include name="${ejb-jar.file}" />
				<include name="${web-war.file}" />
				<include name="${test-war.file}" />
			</fileset>
		</jar>
	</target>

	<target name="deploy" depends="app-ear">
		<copy file="${app-ear.product}"
				todir="${orion.dir}/applications" />
	</target>

</project>

