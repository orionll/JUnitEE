<?xml version="1.0"?>

<!--
	$Id: build.xml,v 1.2 2002-07-31 21:04:30 o_rossmueller Exp $
	$Source: C:\Users\Orionll\Desktop\junitee-cvs/JUnitEE/build.xml,v $

	Build file for JUnit servlet/ejb extensions.

	You will probably need to change the library paths
	and the deployment directory to build.

	Jeff Schnitzer (jeff@infohazard.org)
-->

<project name="junitee" default="all" basedir=".">

	<property name="name" value="junitee" />

  <property name="lib.dir" value="${basedir}/lib"/>
  
	<property name="junit.library" value="${lib.dir}/junit.jar" />
	<property name="servlet.library" value="${lib.dir}/servlet.jar" />
	<property name="j2ee.library" value="${lib.dir}/jboss-j2ee.jar" />

	<property name="deployment.dir" value="/java/orion/lib" />
	<property name="publish.dir" value="/java/orion/default-web-app/junitee" />

 	<property name="src.dir" value="src" />
	<property name="output.dir" value="out" />
	<property name="staging.dir" value="${output.dir}/staging" />
	<property name="website.dir" value="doc" />
	<property name="example.dir" value="example" />

	<target name="clean">
		<deltree dir="${output.dir}" />
	</target>

	<target name="prepare-staging">
		<mkdir dir="${staging.dir}" />
	</target>

 	<target name="classes" depends="prepare-staging">
		<javac srcdir="${src.dir}"
				destdir="${staging.dir}"
				classpath="${junit.library}:${servlet.library}:${j2ee.library}" />
	</target>

	<target name="jar" depends="classes">
		<jar jarfile="${output.dir}/${name}.jar"
				basedir="${staging.dir}" />
	</target>

	<target name="deploy" depends="jar">
		<copyfile src="${output.dir}/${name}.jar"
					dest="${deployment.dir}/${name}.jar" />
	</target>

	<target name="redist" depends="clean, jar">
		<ant dir="${example.dir}" target="clean" />

		<mkdir dir="${output.dir}/redist/junitee/lib" />

		<copyfile src="${output.dir}/${name}.jar"
					dest="${output.dir}/redist/junitee/lib/${name}.jar" />

		<copydir src="."
					dest="${output.dir}/redist/junitee"
 					excludes="${output.dir}/**, ${publish.dir}/**" />

		<zip zipfile="${output.dir}/${name}.zip"
				basedir="${output.dir}/redist" />
	</target>

	<target name="publish" depends="redist">
		<deltree dir="${publish.dir}" />

		<mkdir dir="${publish.dir}" />

		<copyfile src="${output.dir}/${name}.zip"
					dest="${publish.dir}/${name}.zip" />

		<copydir src="${website.dir}"
					dest="${publish.dir}" />
	</target>
  
  <target name="all" depends="jar" description="Build the JUnitEE library"/>
</project>

